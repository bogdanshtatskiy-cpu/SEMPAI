<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Future Size ID</title>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;500;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-gradient: radial-gradient(circle at top right, #2b2b2b, #000000);
            --glass-bg: rgba(255, 255, 255, 0.08);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: #8e8e93;
            --accent: #ff3b30; /* iOS Red */
            --accent-glow: rgba(255, 59, 48, 0.4);
            --radius: 28px;
            --anim-speed: 0.4s;
        }

        body {
            font-family: 'Manrope', sans-serif;
            background: var(--bg-gradient);
            background-attachment: fixed;
            color: var(--text-primary);
            margin: 0;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden; /* –ß—Ç–æ–±—ã –Ω–µ —Å–∫—Ä–æ–ª–ª–∏–ª–æ—Å—å –≤–æ –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–π */
        }

        /* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø—è—Ç–Ω–∞ –Ω–∞ —Ñ–æ–Ω–µ */
        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.6;
        }
        .orb-1 { width: 300px; height: 300px; background: #ff003c; top: -50px; left: -50px; }
        .orb-2 { width: 400px; height: 400px; background: #222; bottom: -100px; right: -100px; }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .app-card {
            width: 100%;
            max-width: 420px;
            height: 90vh;
            max-height: 800px;
            background: var(--glass-bg);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
            transition: all var(--anim-speed);
        }

        /* Header */
        .header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
        }

        .brand {
            font-weight: 800;
            font-size: 18px;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        .brand span { color: var(--accent); }

        .lang-switch {
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: 4px;
            display: flex;
        }

        .lang-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            padding: 5px 12px;
            font-size: 12px;
            border-radius: 16px;
            cursor: pointer;
            transition: 0.3s;
            font-weight: 700;
        }

        .lang-btn.active {
            background: var(--text-primary);
            color: black;
        }

        /* Content Area (Wizard) */
        .screen {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0 30px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.4s ease, transform 0.4s ease;
            position: absolute;
            top: 60px; /* –æ—Ç—Å—Ç—É–ø –ø–æ–¥ —Ö–µ–¥–µ—Ä */
            bottom: 0;
            width: calc(100% - 60px); /* padding —É—á—Ç–µ–Ω */
            pointer-events: none;
        }

        .screen.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
            z-index: 5;
        }

        h2 {
            font-size: 32px;
            line-height: 1.1;
            margin-bottom: 10px;
            font-weight: 700;
        }

        p {
            color: var(--text-secondary);
            font-size: 16px;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        /* Buttons & Inputs */
        .btn-option {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--glass-border);
            padding: 20px;
            border-radius: 20px;
            color: white;
            font-size: 18px;
            font-weight: 500;
            text-align: left;
            margin-bottom: 12px;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .btn-option:hover, .btn-option:active {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.02);
            border-color: var(--accent);
        }

        .btn-option .icon { font-size: 24px; }

        .btn-primary {
            background: var(--accent);
            color: white;
            border: none;
            width: 100%;
            padding: 20px;
            border-radius: 20px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 10px 30px var(--accent-glow);
            transition: 0.3s;
            margin-top: 20px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 40px var(--accent-glow);
        }

        .big-input {
            width: 100%;
            background: none;
            border: none;
            border-bottom: 2px solid #444;
            font-size: 48px;
            color: white;
            font-weight: 800;
            text-align: center;
            padding: 10px 0;
            outline: none;
            transition: 0.3s;
            font-family: 'Manrope', sans-serif;
        }

        .big-input:focus {
            border-color: var(--accent);
        }

        .big-input::placeholder { color: #333; }

        /* Instruction Visual */
        .instruction-box {
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
        }
        .shirt-visual {
            width: 100px;
            height: 100px;
            border: 2px dashed #666;
            margin: 0 auto 10px;
            position: relative;
            border-radius: 10px;
        }
        .measure-line {
            position: absolute;
            background: var(--accent);
        }
        .line-h { width: 2px; height: 100%; left: 50%; top: 0; }
        .line-w { width: 100%; height: 2px; top: 50%; left: 0; }

        /* Progress Bar */
        .progress-container {
            text-align: center;
        }
        .progress-track {
            width: 100%;
            height: 6px;
            background: #333;
            border-radius: 3px;
            margin-top: 20px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            width: 0%;
            background: var(--accent);
            transition: width 3s cubic-bezier(0.22, 1, 0.36, 1);
        }

        /* Result */
        .result-size {
            font-size: 80px;
            font-weight: 800;
            color: var(--accent);
            text-align: center;
            text-shadow: 0 0 30px var(--accent-glow);
            margin: 10px 0;
        }
        .quote {
            text-align: center;
            font-style: italic;
            color: var(--text-secondary);
            font-size: 14px;
            margin-top: 20px;
        }
        
        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: none;
            border: none;
            color: #666;
            font-size: 24px;
            cursor: pointer;
            z-index: 100;
        }

    </style>
</head>
<body>

    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>

    <div class="app-card">
        <div class="header">
            <div class="brand">SIZE<span>ID</span></div>
            <div class="lang-switch">
                <button class="lang-btn active" onclick="setLang('ua')">UA</button>
                <button class="lang-btn" onclick="setLang('ru')">RU</button>
            </div>
        </div>

        <div id="scene-mode" class="screen active">
            <h2 id="txt-mode-title">–ö–∞–∫–æ–π —Ä–µ–∂–∏–º?</h2>
            <p id="txt-mode-desc">–í—ã–±–µ—Ä–∏ —Å–≤–æ–π –ø—É—Ç—å, —Å–∞–º—É—Ä–∞–π.</p>
            
            <button class="btn-option" onclick="selectMode('standard')">
                <span id="btn-std">–û–±—ã—á–Ω—ã–π</span> <span class="icon">üöÄ</span>
            </button>
            <button class="btn-option" onclick="selectMode('advanced')">
                <span id="btn-adv">PRO –ó–∞–º–µ—Ä—ã</span> <span class="icon">üìè</span>
            </button>
        </div>

        <div id="scene-cat" class="screen">
            <button class="back-btn" onclick="goBack('scene-mode')">‚Üê</button>
            <h2 id="txt-cat-title">–î–ª—è –∫–æ–≥–æ —à—å–µ–º?</h2>
            <p id="txt-cat-desc">–û–ø—Ä–µ–¥–µ–ª–∏–º—Å—è —Å –ª–µ–∫–∞–ª–∞–º–∏.</p>

            <button class="btn-option" onclick="selectCategory('men')">
                <span id="btn-men">–ú—É–∂—Å–∫–æ–µ / Unisex</span> <span class="icon">üëï</span>
            </button>
            <button class="btn-option" onclick="selectCategory('women')">
                <span id="btn-women">–ñ–µ–Ω—Å–∫–æ–µ</span> <span class="icon">üëó</span>
            </button>
            <button class="btn-option" onclick="selectCategory('kids')">
                <span id="btn-kids">–î–µ—Ç—Å–∫–æ–µ</span> <span class="icon">üë∂</span>
            </button>
        </div>

        <div id="scene-height" class="screen">
            <button class="back-btn" onclick="goBack('scene-cat')">‚Üê</button>
            <h2 id="txt-height-title">–¢–≤–æ–π —Ä–æ—Å—Ç?</h2>
            <p id="txt-height-desc">–í —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–∞—Ö. –ù–µ –ø—Ä–∏–±–∞–≤–ª—è–π, –º—ã –ø—Ä–æ–≤–µ—Ä–∏–º.</p>
            
            <input type="number" id="val-height" class="big-input" placeholder="175" onkeydown="if(event.key === 'Enter') nextFromHeight()">
            <button class="btn-primary" onclick="nextFromHeight()" id="btn-next-h">–î–∞–ª–µ–µ</button>
        </div>

        <div id="scene-weight" class="screen">
            <button class="back-btn" onclick="goBack('scene-height')">‚Üê</button>
            <h2 id="txt-weight-title">–ê –≤–µ—Å?</h2>
            <p id="txt-weight-desc">–¢–æ–ª—å–∫–æ —á–µ—Å—Ç–Ω–æ. –Ø –Ω–∏–∫–æ–º—É –Ω–µ —Å–∫–∞–∂—É.</p>
            
            <input type="number" id="val-weight" class="big-input" placeholder="70" onkeydown="if(event.key === 'Enter') calculateStandard()">
            <button class="btn-primary" onclick="calculateStandard()" id="btn-calc-std">–£–∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä</button>
        </div>

        <div id="scene-adv-intro" class="screen">
            <button class="back-btn" onclick="goBack('scene-cat')">‚Üê</button>
            <h2 id="txt-adv-title">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</h2>
            <p id="txt-adv-desc">–í–æ–∑—å–º–∏ –ª—é–±–∏–º—É—é —Ñ—É—Ç–±–æ–ª–∫—É –∏ –ø–æ–ª–æ–∂–∏ –Ω–∞ —Å—Ç–æ–ª.</p>
            
            <div class="instruction-box">
                <div class="shirt-visual"></div>
                <div style="font-size:14px; color:#bbb;" id="txt-adv-tip">–ú–µ—Ä—è–µ–º –ø–ª–æ—Å–∫—É—é –≤–µ—â—å, –Ω–µ –Ω–∞ —Ç–µ–ª–µ!</div>
            </div>
            
            <button class="btn-primary" onclick="goToScene('scene-adv-len')" id="btn-start-measure">–ü–æ–Ω—è—Ç–Ω–æ, –ø–æ–≥–Ω–∞–ª–∏</button>
        </div>

        <div id="scene-adv-len" class="screen">
            <button class="back-btn" onclick="goBack('scene-adv-intro')">‚Üê</button>
            <h2 id="txt-len-title">–í—ã—Å–æ—Ç–∞ (A)</h2>
            <p id="txt-len-desc">–û—Ç —Å–∞–º–æ–π –≤–µ—Ä—Ö–Ω–µ–π —Ç–æ—á–∫–∏ –ø–ª–µ—á–∞ –¥–æ —Å–∞–º–æ–≥–æ –Ω–∏–∑–∞.</p>
            
            <div class="instruction-box" style="padding:10px;">
                <div class="shirt-visual"><div class="measure-line line-h"></div></div>
            </div>

            <input type="number" id="val-l" class="big-input" placeholder="72" onkeydown="if(event.key === 'Enter') goToScene('scene-adv-wid')">
            <button class="btn-primary" onclick="goToScene('scene-adv-wid')" id="btn-next-len">–î–∞–ª–µ–µ</button>
        </div>

        <div id="scene-adv-wid" class="screen">
            <button class="back-btn" onclick="goBack('scene-adv-len')">‚Üê</button>
            <h2 id="txt-wid-title">–®–∏—Ä–∏–Ω–∞ (B)</h2>
            <p id="txt-wid-desc">–û—Ç –ø–æ–¥–º—ã—à–∫–∏ –¥–æ –ø–æ–¥–º—ã—à–∫–∏. –°–∞–º–∞—è —à–∏—Ä–æ–∫–∞—è —á–∞—Å—Ç—å.</p>
            
            <div class="instruction-box" style="padding:10px;">
                <div class="shirt-visual"><div class="measure-line line-w"></div></div>
            </div>

            <input type="number" id="val-w" class="big-input" placeholder="52" onkeydown="if(event.key === 'Enter') calculateAdvanced()">
            <button class="btn-primary" onclick="calculateAdvanced()" id="btn-calc-adv">–§–∏–Ω–∏—à</button>
        </div>

        <div id="scene-loading" class="screen">
            <div class="progress-container">
                <h2 id="txt-loading">–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö...</h2>
                <div class="progress-track">
                    <div class="progress-fill" id="progress-bar"></div>
                </div>
            </div>
        </div>

        <div id="scene-result" class="screen">
            <h2 style="text-align:center;" id="txt-res-title">–¢–≤–æ–π —Ä–∞–∑–º–µ—Ä</h2>
            <div class="result-size" id="res-val">XL</div>
            <p class="quote" id="res-quote">"–¶–∏—Ç–∞—Ç–∞..."</p>
            
            <button class="btn-primary" onclick="location.reload()" style="background:transparent; border:1px solid #444;" id="btn-restart">–ó–∞–Ω–æ–≤–æ</button>
        </div>

    </div>

<script>
    // --- TEXTS & LOCALIZATION ---
    const TEXTS = {
        ua: {
            modeT: "–Ø–∫–∏–π —Ä–µ–∂–∏–º?", modeD: "–û–±–µ—Ä–∏ —Å–≤—ñ–π —à–ª—è—Ö.",
            std: "–ü—Ä–æ—Å—Ç–∏–π (–ó—Ä—ñ—Å—Ç/–í–∞–≥–∞)", adv: "PRO (–ó–∞–º—ñ—Ä–∏)",
            catT: "–î–ª—è –∫–æ–≥–æ?", catD: "–û–±–µ—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é.",
            men: "–ß–æ–ª–æ–≤—ñ—á–∞ / Unisex", women: "–ñ—ñ–Ω–æ—á–∞", kids: "–î–∏—Ç—è—á–∞",
            hT: "–¢–≤—ñ–π –∑—Ä—ñ—Å—Ç?", hD: "–í —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–∞—Ö. –ù–µ –∑–∞–≤–∏—â—É–π :)",
            wT: "–ê –≤–∞–≥–∞?", wD: "–¢—ñ–ª—å–∫–∏ —á–µ—Å–Ω–æ, —è –Ω—ñ–∫–æ–º—É –Ω–µ —Å–∫–∞–∂—É.",
            advT: "–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è", advD: "–í—ñ–∑—å–º–∏ —É–ª—é–±–ª–µ–Ω—É —Ñ—É—Ç–±–æ–ª–∫—É —Ç–∞ –ø–æ–∫–ª–∞–¥–∏ –Ω–∞ —Å—Ç—ñ–ª.",
            tip: "–ú—ñ—Ä—è—î–º–æ —Ä—ñ—á –Ω–∞ —Å—Ç–æ–ª—ñ, –∞ –Ω–µ –Ω–∞ —Å–æ–±—ñ!",
            startM: "–ó—Ä–æ–∑—É–º—ñ–ª–æ, –ø–æ—ó—Ö–∞–ª–∏",
            lenT: "–í–∏—Å–æ—Ç–∞ (A)", lenD: "–í—ñ–¥ –ø–ª–µ—á–∞ –¥–æ —Å–∞–º–æ–≥–æ –Ω–∏–∑—É.",
            widT: "–®–∏—Ä–∏–Ω–∞ (B)", widD: "–í—ñ–¥ –ø–∞—Ö–≤–∏ –¥–æ –ø–∞—Ö–≤–∏.",
            next: "–î–∞–ª—ñ", calc: "–î—ñ–∑–Ω–∞—Ç–∏—Å—å —Ä–æ–∑–º—ñ—Ä",
            load: "–ù–µ–π—Ä–æ–º–µ—Ä–µ–∂–∞ –¥—É–º–∞—î...",
            resT: "–¢–≤—ñ–π —ñ–¥–µ–∞–ª—å–Ω–∏–π:",
            restart: "–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ —â–µ",
            quotes: [
                "–°—è–¥–µ —è–∫ –≤–ª–∏—Ç–∞. –ì–æ—Ç—É–π—Å—è –¥–æ —É–≤–∞–≥–∏.",
                "–¶–µ–π —Ä–æ–∑–º—ñ—Ä –ø—Ä–∏—Ö–æ–≤–∞—î –≤—Å—ñ —Å–ª—ñ–¥–∏ —Å–º–∞—á–Ω–∏—Ö –æ–±—ñ–¥—ñ–≤.",
                "–î–ª—è —Å–ø—Ä–∞–≤–∂–Ω—å–æ–≥–æ –±–æ—Å–∞.",
                "–Ü–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Ç–≤–æ–≥–æ –∞—É—Ç—Ñ—ñ—Ç—É.",
                "–í —Ü—å–æ–º—É —Ç–∏ –ø—ñ–¥–∫–æ—Ä–∏—à —Ü–µ–π —Å–≤—ñ—Ç.",
                "–Ø–∫—â–æ –Ω–µ –ø—ñ–¥—ñ–π–¥–µ - —Ü–µ –Ω–µ –∂–∏—Ä, —Ü–µ —Ö–∞—Ä–∏–∑–º–∞."
            ]
        },
        ru: {
            modeT: "–ö–∞–∫–æ–π —Ä–µ–∂–∏–º?", modeD: "–í—ã–±–µ—Ä–∏ —Å–≤–æ–π –ø—É—Ç—å.",
            std: "–ü—Ä–æ—Å—Ç–æ–π (–†–æ—Å—Ç/–í–µ—Å)", adv: "PRO (–ó–∞–º–µ—Ä—ã)",
            catT: "–î–ª—è –∫–æ–≥–æ?", catD: "–í—ã–±–µ—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é.",
            men: "–ú—É–∂—Å–∫–∞—è / Unisex", women: "–ñ–µ–Ω—Å–∫–∞—è", kids: "–î–µ—Ç—Å–∫–∞—è",
            hT: "–¢–≤–æ–π —Ä–æ—Å—Ç?", hD: "–í —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–∞—Ö. –¢–æ–ª—å–∫–æ —á–µ—Å—Ç–Ω–æ :)",
            wT: "–ê –≤–µ—Å?", wD: "–ê–∫–∫—É—Ä–∞—Ç–Ω–æ, —è –Ω–∏–∫–æ–º—É –Ω–µ —Å–∫–∞–∂—É.",
            advT: "–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è", advD: "–í–æ–∑—å–º–∏ –ª—é–±–∏–º—É—é —Ñ—É—Ç–±–æ–ª–∫—É –∏ –ø–æ–ª–æ–∂–∏ –Ω–∞ —Å—Ç–æ–ª.",
            tip: "–ú–µ—Ä—è–µ–º –≤–µ—â—å –Ω–∞ —Å—Ç–æ–ª–µ, –∞ –Ω–µ –Ω–∞ —Å–µ–±–µ!",
            startM: "–ü–æ–Ω—è—Ç–Ω–æ, –ø–æ–≥–Ω–∞–ª–∏",
            lenT: "–í—ã—Å–æ—Ç–∞ (A)", lenD: "–û—Ç –ø–ª–µ—á–∞ –¥–æ —Å–∞–º–æ–≥–æ –Ω–∏–∑–∞.",
            widT: "–®–∏—Ä–∏–Ω–∞ (B)", widD: "–û—Ç –ø–æ–¥–º—ã—à–∫–∏ –¥–æ –ø–æ–¥–º—ã—à–∫–∏.",
            next: "–î–∞–ª–µ–µ", calc: "–£–∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä",
            load: "–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ...",
            resT: "–¢–≤–æ–π –∏–¥–µ–∞–ª:",
            restart: "–ó–∞–Ω–æ–≤–æ",
            quotes: [
                "–°—è–¥–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ. –ö–∞–∫ —Ç–≤–æ–∏ –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ –≥–æ–ª–æ–≤—É.",
                "–≠—Ç–æ—Ç —Ä–∞–∑–º–µ—Ä —Å–∫—Ä–æ–µ—Ç –≤—Å–µ —Å–ª–µ–¥—ã –Ω–æ—á–Ω—ã—Ö –ø–µ—Ä–µ–∫—É—Å–æ–≤.",
                "–í —ç—Ç–æ–º —Ç—ã –±—É–¥–µ—à—å –≤—ã–≥–ª—è–¥–µ—Ç—å –Ω–∞ –º–∏–ª–ª–∏–æ–Ω.",
                "–†–∞–∑–º–µ—Ä –ø–æ–¥–æ–±—Ä–∞–Ω. –û—Å—Ç–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –¥–µ–Ω—å–≥–∏.",
                "100% —Å—Ç–∏–ª—å, 0% –æ—Å—É–∂–¥–µ–Ω–∏—è.",
                "–ï—Å–ª–∏ –º–∞–ª–æ - –∑–Ω–∞—á–∏—Ç —Ç—ã –ø—Ä–æ—Å—Ç–æ —Å–ª–∏—à–∫–æ–º –º–æ—â–Ω—ã–π."
            ]
        }
    };

    // --- DATA ---
    const SIZE_DATA = {
        men: [
            { name: '2XS', w: 43, l: 66 }, { name: 'XS', w: 46, l: 68 },
            { name: 'S', w: 49, l: 70 }, { name: 'M', w: 52, l: 72 },
            { name: 'L', w: 55, l: 74 }, { name: 'XL', w: 58, l: 76 },
            { name: '2XL', w: 61, l: 78 }, { name: '3XL', w: 64, l: 80 },
            { name: '4XL', w: 70, l: 82 }, { name: '5XL', w: 75, l: 84 }
        ],
        women: [
            { name: 'XS', w: 42, l: 62 }, { name: 'S', w: 45, l: 64 },
            { name: 'M', w: 48, l: 66 }, { name: 'L', w: 51, l: 68 },
            { name: 'XL', w: 55, l: 70 }, { name: '2XL', w: 59, l: 71 },
            { name: '3XL', w: 62, l: 71 }
        ],
        kids: [
            { name: '3XS', w: 30, l: 38, maxH: 92 },
            { name: '2XS', w: 33, l: 42, maxH: 104 },
            { name: 'XS', w: 36, l: 44, maxH: 116 },
            { name: 'S', w: 39, l: 50, maxH: 128 },
            { name: 'M', w: 42, l: 54, maxH: 140 },
            { name: 'L', w: 45, l: 60, maxH: 152 },
            { name: 'XL', w: 48, l: 64, maxH: 164 }
        ]
    };

    // --- STATE ---
    let state = {
        lang: 'ua',
        mode: null,
        category: null
    };

    // --- NAVIGATION ---
    function goToScene(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        
        // Auto-focus input if exists
        const inp = document.getElementById(id).querySelector('input');
        if(inp) setTimeout(() => inp.focus(), 500);
    }

    function goBack(id) {
        goToScene(id);
    }

    // --- ACTIONS ---
    function setLang(l) {
        state.lang = l;
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        document.querySelector(`.lang-btn[onclick="setLang('${l}')"]`).classList.add('active');
        updateTexts();
    }

    function selectMode(m) {
        state.mode = m;
        goToScene('scene-cat');
    }

    function selectCategory(c) {
        state.category = c;
        if (state.mode === 'standard') {
            goToScene('scene-height');
        } else {
            goToScene('scene-adv-intro');
        }
    }

    function nextFromHeight() {
        const h = document.getElementById('val-height').value;
        if (!h) return alert(state.lang === 'ua' ? "–í–≤–µ–¥–∏ –∑—Ä—ñ—Å—Ç!" : "–í–≤–µ–¥–∏ —Ä–æ—Å—Ç!");

        if (state.category === 'kids') {
            calculateStandard(); // Kids skip weight
        } else {
            goToScene('scene-weight');
        }
    }

    // --- CALCULATION & RESULT ---
    function startLoading(callback) {
        goToScene('scene-loading');
        document.getElementById('progress-bar').style.width = '0%';
        // Force reflow
        void document.getElementById('progress-bar').offsetWidth;
        document.getElementById('progress-bar').style.width = '100%';
        
        setTimeout(callback, 3000);
    }

    function calculateStandard() {
        const h = parseFloat(document.getElementById('val-height').value);
        let w = 0;
        if (state.category !== 'kids') {
            w = parseFloat(document.getElementById('val-weight').value);
            if (!w) return alert("–í–µ—Å?");
        }

        startLoading(() => {
            let size = "L";
            // Logic
            if (state.category === 'kids') {
                const chart = SIZE_DATA.kids;
                size = "XL+";
                for (let s of chart) { if (h <= s.maxH) { size = s.name; break; } }
            } else if (state.category === 'men') {
                if (w < 55) size = "2XS";
                else if (w < 62) size = "XS";
                else if (w < 70) size = "S";
                else if (w < 78) size = "M";
                else if (w < 86) size = "L";
                else if (w < 95) size = "XL";
                else if (w < 105) size = "2XL";
                else if (w < 115) size = "3XL";
                else if (w < 125) size = "4XL";
                else size = "5XL";
            } else { // women
                if (w < 45) size = "XS";
                else if (w < 52) size = "S";
                else if (w < 60) size = "M";
                else if (w < 68) size = "L";
                else if (w < 76) size = "XL";
                else if (w < 85) size = "2XL";
                else size = "3XL";
            }
            showResult(size);
        });
    }

    function calculateAdvanced() {
        const l = parseFloat(document.getElementById('val-l').value);
        const w = parseFloat(document.getElementById('val-w').value);
        if (!l || !w) return alert("–î–∞–Ω–Ω—ã–µ?");

        startLoading(() => {
            const chart = SIZE_DATA[state.category];
            let size = chart[chart.length-1].name;
            for (let s of chart) {
                if (s.w >= w - 1 && s.l >= l - 2) {
                    size = s.name;
                    break;
                }
            }
            showResult(size);
        });
    }

    function showResult(size) {
        document.getElementById('res-val').innerText = size;
        const quotes = TEXTS[state.lang].quotes;
        document.getElementById('res-quote').innerText = quotes[Math.floor(Math.random() * quotes.length)];
        goToScene('scene-result');
    }

    function updateTexts() {
        const t = TEXTS[state.lang];
        // Mode
        document.getElementById('txt-mode-title').innerText = t.modeT;
        document.getElementById('txt-mode-desc').innerText = t.modeD;
        document.getElementById('btn-std').innerText = t.std;
        document.getElementById('btn-adv').innerText = t.adv;
        // Cat
        document.getElementById('txt-cat-title').innerText = t.catT;
        document.getElementById('txt-cat-desc').innerText = t.catD;
        document.getElementById('btn-men').innerText = t.men;
        document.getElementById('btn-women').innerText = t.women;
        document.getElementById('btn-kids').innerText = t.kids;
        // Height
        document.getElementById('txt-height-title').innerText = t.hT;
        document.getElementById('txt-height-desc').innerText = t.hD;
        document.getElementById('btn-next-h').innerText = t.next;
        // Weight
        document.getElementById('txt-weight-title').innerText = t.wT;
        document.getElementById('txt-weight-desc').innerText = t.wD;
        document.getElementById('btn-calc-std').innerText = t.calc;
        // Adv Intro
        document.getElementById('txt-adv-title').innerText = t.advT;
        document.getElementById('txt-adv-desc').innerText = t.advD;
        document.getElementById('txt-adv-tip').innerText = t.tip;
        document.getElementById('btn-start-measure').innerText = t.startM;
        // Len
        document.getElementById('txt-len-title').innerText = t.lenT;
        document.getElementById('txt-len-desc').innerText = t.lenD;
        document.getElementById('btn-next-len').innerText = t.next;
        // Wid
        document.getElementById('txt-wid-title').innerText = t.widT;
        document.getElementById('txt-wid-desc').innerText = t.widD;
        document.getElementById('btn-calc-adv').innerText = t.calc;
        // Result
        document.getElementById('txt-loading').innerText = t.load;
        document.getElementById('txt-res-title').innerText = t.resT;
        document.getElementById('btn-restart').innerText = t.restart;
    }

    // Init
    updateTexts();

</script>
</body>
</html>
